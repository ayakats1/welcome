<h2>投稿詳細</h2>
  <table class='table table-borderless'>
    <tr>
      <th>
        <% if @post.image.attached? %>
          <%= image_tag @post.image, size: "300x300" %>
        <% end %>
      </th>
    </tr>
    <tr>
      <th width="30%">タイトル</th>
      <th width="70%"><%= @post.title %></th>
    </tr>
    <tr>
      <th>内容</th>
      <th><%= @post.body %></th>
    </tr>
    <tr>
      <th>開始日</th>
      <% weeks = ["月","火","水","木","金","土","日"] %>
      <% index = @post.created_at_gteq.strftime("%u").to_i %>
      <% index2 = @post.created_at_lteq_end_of_day.strftime("%u").to_i %>
      <th><%= @post.created_at_gteq.strftime("%Y年%-m月%-d日 #{weeks[index - 1]}曜日") %>
          ~<%= @post.created_at_lteq_end_of_day.strftime("%Y年%-m月%-d日 #{weeks[index2 - 1]}曜日") %></th>
    </tr>
  </table>

  <%= link_to edit_shop_post_path, class: "btn btn-success" do %>編集する
  <% end %>
  <%= link_to "削除", shop_post_path(@post.id), class: "btn btn btn-danger", method: :delete, "data-confirm" => "本当に消しますか？" %>
  
  
  <input id="address" type="textbox" value="">
  <input type="button" value="地図を検索" onclick="codeAddress()">
  <div id="display">緯度経度が表示されるよ！</div>
  
  <div id='map'></div>
  
  <style>
      #map {
          height: 400px;
          width: 400px;
      }
  </style>
  
  <script>
      let map
  
      const display = document.getElementById('display')
  
      // mapの表示関数 
      function initMap() {
          geocoder = new google.maps.Geocoder()
  
          // mapの初期位置, 縮尺を定義
          map = new google.maps.Map(document.getElementById('map'), {
              center: {
                  lat: 35.6458437,
                  lng: 139.7046171
              },
              zoom: 12,
          });
  
          // mapsテーブルにあるそれぞれのレコードをmap上に表示 
          <% @maps.each do |m| %>
              (function(){
              var contentString = "住所：<%= m.address %>"; 
  
              // マーカーを立てる
              var marker = new google.maps.Marker({
                  position:{lat: <%= m.latitude %>, lng: <%= m.longitude %>},
                  map: map,
                  title: contentString
              });
  
              // 情報ウィンドウ(吹き出し)の定義
              // 投稿の詳細ページへのリンクも
              var infowindow = new google.maps.InfoWindow({
              position: {lat: <%= m.latitude %>, lng: <%= m.longitude %>},
              content: "<a href='<%= map_url(m.id) %>' target='_blank'><%= m.address %></a>"
              });
  
              // クリックしたときに情報ウィンドウを表示
              marker.addListener('click', function() {
              infowindow.open(map, marker);
              });
  
              })();
          <% end %>
      }
  
      let geocoder
  
      // 地図検索関数
      function codeAddress() {
          let inputAddress = document.getElementById('address').value;
  
          geocoder.geocode({
              'address': inputAddress
          }, function (results, status) {
              if (status == 'OK') {
                  map.setCenter(results[0].geometry.location);
                  var marker = new google.maps.Marker({
                      map: map,
                      position: results[0].geometry.location
                  });
  
              display.textContent = "検索結果：" + results[ 0 ].geometry.location
              } else {
                  alert('該当する結果がありませんでした：' + status);
              }
          });
      }
  </script>
  
  <script
      src="https://maps.googleapis.com/maps/api/js?key=<%= ENV['GOOGLE_MAP_API_KEY'] %>&callback=initMap"  
      async defer>
  </script>